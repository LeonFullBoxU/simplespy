-- ESP Functionality to show names above players
local function createESP(player)
    local character = player.Character
    if character and not character:FindFirstChild("ESPName") then
        local head = character:FindFirstChild("Head")
        if head then
            local billboardGui = Instance.new("BillboardGui", head)
            billboardGui.Name = "ESPName"
            billboardGui.Size = UDim2.new(0, 100, 0, 50)
            billboardGui.StudsOffset = Vector3.new(0, 2, 0)
            billboardGui.AlwaysOnTop = true

            local textLabel = Instance.new("TextLabel", billboardGui)
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.Text = player.Name
            textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.Font = Enum.Font.GothamBold
            textLabel.TextScaled = true
        end
    end
end

-- Remove ESP when the player leaves
game.Players.PlayerRemoving:Connect(function(player)
    if player.Character then
        local head = player.Character:FindFirstChild("Head")
        if head and head:FindFirstChild("ESPName") then
            head:FindFirstChild("ESPName"):Destroy()
        end
    end
end)

-- Create ESP for all current players
for _, player in pairs(game.Players:GetPlayers()) do
    createESP(player)
end

-- ESP for newly joined players
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        task.wait(1) -- Ensure character is loaded
        createESP(player)
    end)
end)

-- Function to perform actions on a player
local function performActions(player)
    local localPlayer = game.Players.LocalPlayer

    -- 1. Teleport to the username
    if localPlayer.Character and player.Character then
        localPlayer.Character:SetPrimaryPartCFrame(player.Character.PrimaryPart.CFrame)
    else
        warn("Unable to teleport. Character not found.")
    end

    -- Add delay between teleport and events
    task.wait(0.5)

    -- 2. Fire CarryEvent
    local carryEvent = game:GetService("ReplicatedStorage").Events:FindFirstChild("CarryEvent")
    if carryEvent then
        carryEvent:FireServer(player, "request_accepted")
    else
        warn("CarryEvent not found.")
    end

    -- 3. Fire TitleEvent
    local titleEvent = game:GetService("ReplicatedStorage").Events:FindFirstChild("TitleEvent")
    if titleEvent then
        titleEvent:FireServer("NoviceHunter")
    else
        warn("TitleEvent not found.")
    end

    -- 4. Fire Damage Event
    local damageEvent = game:GetService("ReplicatedStorage"):FindFirstChild("jdskhfsIIIllliiIIIdchgdIiIIIlIlIli")
    if damageEvent then
        for i = 1, 20 do
            local humanoid = localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid")
            if humanoid then
                damageEvent:FireServer(humanoid, 5)
            else
                warn("Local player's humanoid not found.")
                break
            end
        end
    else
        warn("Damage event not found.")
    end
end

-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextBox = Instance.new("TextBox")
local Button = Instance.new("TextButton")
local UICornerFrame = Instance.new("UICorner")
local UICornerButton = Instance.new("UICorner")
local UITextSizeConstraint = Instance.new("UITextSizeConstraint")

-- Parent GUI to PlayerGui
ScreenGui.Name = "CustomGUI"
local success, err = pcall(function()
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
end)
if not success then
    warn("Error parenting ScreenGui: ", err)
    return
end

-- Frame properties
Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(40, 44, 52)
Frame.Size = UDim2.new(0, 350, 0, 200)
Frame.Position = UDim2.new(0.5, -175, 0.5, -100)
Frame.AnchorPoint = Vector2.new(0.5, 0.5)
Frame.Visible = true

-- Add rounded corners to Frame
UICornerFrame.Parent = Frame
UICornerFrame.CornerRadius = UDim.new(0.05, 0)

-- TextBox properties
TextBox.Parent = Frame
TextBox.Size = UDim2.new(0.8, 0, 0.2, 0)
TextBox.Position = UDim2.new(0.1, 0, 0.25, 0)
TextBox.PlaceholderText = "Enter Username"
TextBox.Text = ""
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.BackgroundColor3 = Color3.fromRGB(50, 54, 62)
TextBox.Font = Enum.Font.Gotham
TextBox.TextSize = 16

UITextSizeConstraint.Parent = TextBox
UITextSizeConstraint.MaxTextSize = 18

-- Button properties
Button.Parent = Frame
Button.Size = UDim2.new(0.8, 0, 0.2, 0)
Button.Position = UDim2.new(0.1, 0, 0.6, 0)
Button.Text = "Execute"
Button.TextColor3 = Color3.fromRGB(255, 255, 255)
Button.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
Button.Font = Enum.Font.Gotham
Button.TextSize = 16

-- Add rounded corners to Button
UICornerButton.Parent = Button
UICornerButton.CornerRadius = UDim.new(0.05, 0)

-- Button hover effect
Button.MouseEnter:Connect(function()
    Button.BackgroundColor3 = Color3.fromRGB(100, 150, 200)
end)

Button.MouseLeave:Connect(function()
    Button.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
end)

-- Button functionality
Button.MouseButton1Click:Connect(function()
    local username = TextBox.Text
    if username == "" then
        warn("Please enter a username.")
        return
    end

    local player = game.Players:FindFirstChild(username)
    if not player then
        warn("Player not found: " .. username)
        return
    end

    performActions(player)
end)

-- Player click functionality
local playerMouse = game.Players.LocalPlayer:GetMouse()
playerMouse.Button1Down:Connect(function()
    local target = playerMouse.Target and playerMouse.Target.Parent
    if target and game.Players:FindFirstChild(target.Name) then
        performActions(game.Players[target.Name])
    else
        warn("No valid player target found.")
    end
end)
